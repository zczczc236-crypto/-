<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì „ì„¤ì˜ ê²€ ê°•í™”í•˜ê¸°: ì–¼í‹°ë°‹</title>
    <style>
        :root {
            --primary: #f1c40f;
            --secondary: #e67e22;
            --danger: #e74c3c;
            --success: #2ecc71;
            --bg: #1a1a2e;
        }

        body {
            margin: 0; padding: 0; font-family: 'Pretendard', sans-serif;
            background: var(--bg); color: white;
            display: flex; justify-content: center; align-items: center; min-height: 100vh;
            touch-action: manipulation; /* ëª¨ë°”ì¼ ë”ë¸”íƒ­ ë°©ì§€ */
        }

        .game-wrapper {
            width: 90%; max-width: 450px; background: #16213e;
            padding: 20px; border-radius: 20px; box-shadow: 0 0 50px rgba(0,0,0,0.8);
            border: 2px solid #0f3460; text-align: center;
        }

        /* ìƒë‹¨ ìì› ë°” */
        .resource-bar {
            display: flex; justify-content: space-around; background: #0f3460;
            padding: 10px; border-radius: 10px; margin-bottom: 20px; font-weight: bold;
        }

        /* ë©”ì¸ ì•„ì´í…œ ì˜ì—­ */
        .item-card {
            padding: 40px 20px; background: radial-gradient(circle, #1f4068 0%, #16213e 100%);
            border-radius: 15px; margin-bottom: 20px; position: relative;
            transition: transform 0.1s;
        }

        .item-name { font-size: 1.8rem; margin: 10px 0; color: var(--primary); font-weight: 800; }
        .item-stat { font-size: 0.9rem; color: #95a5a6; }

        /* í™•ë¥  ë° ë¹„ìš© ì •ë³´ */
        .info-panel { margin-bottom: 20px; font-size: 0.95rem; }
        .cost-text { color: #bdc3c7; }

        /* ë²„íŠ¼ ë° ì•¡ì…˜ */
        button {
            width: 100%; padding: 18px; border: none; border-radius: 10px;
            font-size: 1.2rem; font-weight: bold; cursor: pointer;
            background: linear-gradient(to bottom, var(--secondary), #d35400);
            color: white; box-shadow: 0 5px 0 #a04000; transition: 0.1s;
        }

        button:active { transform: translateY(4px); box-shadow: 0 1px 0 #a04000; }
        button:disabled { background: #7f8c8d; box-shadow: 0 5px 0 #2c3e50; opacity: 0.6; }

        /* ë¡œê·¸ */
        .log-container {
            height: 120px; overflow-y: auto; background: #1a1a2e;
            margin-top: 20px; border-radius: 8px; padding: 10px;
            font-size: 0.85rem; text-align: left; border: 1px solid #0f3460;
        }

        /* ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ */
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            20% { transform: translate(-3px, 0px) rotate(-1deg); }
            40% { transform: translate(3px, 2px) rotate(1deg); }
            100% { transform: translate(1px, -1px) rotate(0deg); }
        }
        .shake { animation: shake 0.3s linear; }
    </style>
</head>
<body>

<div class="game-wrapper">
    <div class="resource-bar">
        <span>ğŸ’° <span id="gold">1000</span></span>
        <span>ğŸ’ <span id="stone">5</span></span>
    </div>

    <div id="itemCard" class="item-card">
        <div class="item-stat" id="rarity">COMMON</div>
        <div class="item-name" id="itemName">ë¹›ë°”ëœ ì—°ìŠµìš© ê²€ (+0)</div>
        <div class="item-stat" id="damage">ê³µê²©ë ¥: 10</div>
    </div>

    <div class="info-panel">
        <div>ì„±ê³µ í™•ë¥ : <span id="prob">100</span>%</div>
        <div class="cost-text">í•„ìš” ë¹„ìš©: <span id="costGold">100</span>G, <span id="costStone">1</span>ğŸ’</div>
    </div>

    <button id="enhanceBtn" onclick="tryEnhance()">ê°•í™” ì‹œë„</button>

    <div class="log-container" id="gameLog">
        <div>ëŒ€ì¥ì¥ì´ê°€ ë‹¹ì‹ ì„ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.</div>
    </div>
</div>

<script>
    // ê²Œì„ ë°ì´í„°
    let state = {
        level: 0,
        gold: 1000,
        stone: 10,
        baseDamage: 10
    };

    // ì‚¬ìš´ë“œ ê°ì²´ (ë¸Œë¼ìš°ì € ì •ì±…ìƒ ì²« í´ë¦­ í›„ í™œì„±í™”)
    const sounds = {
        success: new Audio('https://actions.google.com/sounds/v1/alarms/beep_short.ogg'),
        fail: new Audio('https://actions.google.com/sounds/v1/water/big_splash.ogg'),
        break: new Audio('https://actions.google.com/sounds/v1/impact/metal_clutter.ogg')
    };

    // ìë™ ìˆ˜ê¸‰ ì‹œìŠ¤í…œ (ì¬ë¯¸ë¥¼ ìœ„í•´)
    setInterval(() => {
        state.gold += 5;
        state.stone += (Math.random() > 0.9) ? 1 : 0;
        updateUI();
    }, 2000);

    function getProb(lvl) {
        if (lvl < 3) return 100;
        if (lvl < 7) return 80 - (lvl * 5);
        if (lvl < 10) return 40 - (lvl * 2);
        return 5;
    }

    function getCosts(lvl) {
        return {
            gold: 100 + (lvl * 150),
            stone: 1 + Math.floor(lvl / 5)
        };
    }

    function tryEnhance() {
        const costs = getCosts(state.level);
        if (state.gold < costs.gold || state.stone < costs.stone) {
            addLog("ì¬ë£Œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!");
            return;
        }

        // ë¹„ìš© ì°¨ê°
        state.gold -= costs.gold;
        state.stone -= costs.stone;

        const roll = Math.random() * 100;
        const prob = getProb(state.level);
        const card = document.getElementById('itemCard');

        if (roll <= prob) {
            // ì„±ê³µ
            state.level++;
            sounds.success.play();
            addLog(`<span style="color:#2ecc71">ê°•í™” ì„±ê³µ! (+${state.level})</span>`);
            animateCard('shake');
        } else {
            // ì‹¤íŒ¨ ë¡œì§
            if (state.level >= 10) { // 10ê°•ë¶€í„° íŒŒê´´ ìœ„í—˜
                if (Math.random() < 0.3) {
                    state.level = 0;
                    sounds.break.play();
                    addLog(`<span style="color:#e74c3c">ì•—! ì•„ì´í…œì´ íŒŒê´´ë˜ì—ˆìŠµë‹ˆë‹¤! (+0ë¶€í„° ì¬ì‹œì‘)</span>`);
                } else {
                    state.level = Math.max(0, state.level - 1);
                    sounds.fail.play();
                    addLog("ì‹¤íŒ¨ë¡œ ê°•í™” ìˆ˜ì¹˜ê°€ í•˜ë½í–ˆìŠµë‹ˆë‹¤.");
                }
            } else {
                sounds.fail.play();
                addLog("ê°•í™”ì— ì‹¤íŒ¨í–ˆì§€ë§Œ ë‹¤í–‰íˆ ë³€í™”ëŠ” ì—†ìŠµë‹ˆë‹¤.");
            }
        }
        updateUI();
    }

    function updateUI() {
        document.getElementById('gold').innerText = Math.floor(state.gold);
        document.getElementById('stone').innerText = state.stone;
        
        const costs = getCosts(state.level);
        document.getElementById('costGold').innerText = costs.gold;
        document.getElementById('costStone').innerText = costs.stone;
        
        document.getElementById('prob').innerText = getProb(state.level);
        
        const itemName = state.level >= 10 ? "ğŸ”¥ ì „ì„¤ì˜ ë“œë˜ê³¤ ìŠ¬ë ˆì´ì–´" : "ë¹›ë°”ëœ ì—°ìŠµìš© ê²€";
        document.getElementById('itemName').innerText = `${itemName} (+${state.level})`;
        document.getElementById('damage').innerText = `ê³µê²©ë ¥: ${state.baseDamage + (state.level * 15)}`;
        
        const rarity = state.level < 5 ? "COMMON" : state.level < 10 ? "RARE" : "LEGENDARY";
        document.getElementById('rarity').innerText = rarity;
        document.getElementById('rarity').style.color = rarity === "LEGENDARY" ? "#f1c40f" : "#95a5a6";
    }

    function addLog(msg) {
        const log = document.getElementById('gameLog');
        const div = document.createElement('div');
        div.innerHTML = `> ${msg}`;
        log.prepend(div);
    }

    function animateCard(className) {
        const card = document.getElementById('itemCard');
        card.classList.add(className);
        setTimeout(() => card.classList.remove(className), 300);
    }
</script>

</body>
</html>
